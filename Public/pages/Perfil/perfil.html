<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil - Rede Social de Saúde</title>
    <link id="styleSheetLink" rel="stylesheet"  href="https://jheynial.github.io/MageSaude/Public/pages/Perfil/perfil.css" media="screen">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
</head>
<body>
    <div class="menu-center">
    <nav class="menu">
        <input type="checkbox" ref="#" class="menu-open" name="menu-open" id="menu-open"/>
        <label class="menu-open-button" for="menu-open">
          <span class="hamburger hamburger-1"></span>
          <span class="hamburger hamburger-2"></span>
          <span class="hamburger hamburger-3"></span>
        </label>
        
        <a href="https://web.facebook.com/prefeituramage/?locale=pt_BR&_rdc=1&_rdr" target=”_blank” class="menu-item" title="facebook"> <i class="fab fa-facebook "></i> </a>
        <a href="https://www.instagram.com/prefeitura_mage/" target=”_blank” class="menu-item"  title="instagram"> <i class="fab fa-instagram"></i> </a>
        <a href="https://webmail.mage.rj.gov.br/" target=”_blank” class="menu-item"  title="webmail"> <i class="far fa-envelope"></i> </a>
        <a href="https://www.linkedin.com/company/prefeiturademage?originalSubdomain=br" target=”_blank” class="menu-item"  title="linkedin"><i class="fab fa-linkedin"></i> </a>

        
      </nav>
    </div>
      <!-- filters -->
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
    <defs>
      <filter id="shadowed-goo">
          
          <feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="10" />
          <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="goo" />
          <feGaussianBlur in="goo" stdDeviation="3" result="shadow" />
          <feColorMatrix in="shadow" mode="matrix" values="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 -0.2" result="shadow" />
          <feOffset in="shadow" dx="1" dy="1" result="shadow" />
          <feComposite in2="shadow" in="goo" result="goo" />
          <feComposite in2="goo" in="SourceGraphic" result="mix" />
      </filter>
      <filter id="goo">
          <feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="10" />
          <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="goo" />
          <feComposite in2="goo" in="SourceGraphic" result="mix" />
      </filter>
    </defs>
</svg>

<!---->
    <div class="container" id="perfilContainer">
        <img class="logo" src="https://i.ibb.co/y6pm5Fr/hurt.png" alt="Logo"> <!-- Logo pequena -->
        <h1>Perfil</h1>
        <p><strong>Nome:</strong> <span id="perfilNome"></span></p>
        <p><strong>Email:</strong> <span id="perfilEmail"></span></p>
        <p><strong>CPF:</strong> <span id="perfilCpf"></span></p>
        <p><strong>Telefone:</strong> <span id="perfilTelefone"></span></p>
        <p><strong>Número do SUS:</strong> <span id="perfilSus"></span></p>
        <button class="button_logout" id="logoutButton">Sair</button>
        <button class="button" id="consultasButton">Marcar e Ver Consultas</button>
    </div>

    <!-- botão white -->
    <div>
        <input type="checkbox" class="checkbox" id="toggleStyleSheetCheckbox"/>
        <label class="label" for="toggleStyleSheetCheckbox">
            <i class="fas fa-moon"></i>
            <i class="fas fa-sun"></i>
            <div class="ball"></div>
        </label>
    </div>
    <script>
        // Função para mostrar pop-up de feedback
        function showPopup(message, popupElement) {
            const popup = document.getElementById(popupElement);
            const popupMessage = popup.querySelector('.popup-message');
            popupMessage.textContent = message;
            popup.style.display = 'block';
            setTimeout(() => {
                popup.style.display = 'none';
            }, 3000);
        }

        // Função para formatar o CPF
        function formatarCPF(cpf) {
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        // Função para formatar o número de telefone
        function formatarTelefone(telefone) {
            return telefone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
        }

        // Verifica se há usuário atual logado
        const usuarioAtual = JSON.parse(localStorage.getItem('usuarioAtual'));
        if (!usuarioAtual) {
            window.location.href = 'https://github.com/Jheynial/MageSaude/Public/index.html'; // Redireciona se o usuário não estiver logado
        } else {
            document.getElementById('perfilNome').textContent = `${usuarioAtual.nome} ${usuarioAtual.sobrenome}`;
            document.getElementById('perfilEmail').textContent = usuarioAtual.email;
            document.getElementById('perfilCpf').textContent = formatarCPF(usuarioAtual.cpf);
            document.getElementById('perfilTelefone').textContent = formatarTelefone(usuarioAtual.telefone);
            document.getElementById('perfilSus').textContent = usuarioAtual.sus;
        }

        // Botão de logout
        document.getElementById('logoutButton').addEventListener('click', () => {
            localStorage.removeItem('usuarioAtual');
            window.location.href = '/Public/index.html';
        });

        // Botão para consultar e marcar consultas
        document.getElementById('consultasButton').addEventListener('click', () => {
            window.location.href = 'https://jheynial.github.io/MageSaude/Public/consultas/consultas.html';
        });

        

if (!usuarioAtual) {
    window.location.href = 'https://jheynial.github.io/MageSaude/Public/index.html'; // Redireciona se o usuário não estiver logado
} else {
    document.getElementById('perfilNome').textContent = `${usuarioAtual.nome} ${usuarioAtual.sobrenome}`;
    document.getElementById('perfilEmail').textContent = usuarioAtual.email;
    document.getElementById('perfilCpf').textContent = formatarCPF(usuarioAtual.cpf); // Formatação do CPF
    document.getElementById('perfilTelefone').textContent = formatarTelefone(usuarioAtual.telefone); // Formatação do telefone
    document.getElementById('perfilSus').textContent = usuarioAtual.sus;
}

        
        document.getElementById('logoutButton').addEventListener('click', () => {
            localStorage.removeItem('usuarioAtual');
            window.location.href = 'https://jheynial.github.io/MageSaude/Public/index.html'; // Corrigindo o redirecionamento para o diretório correto
        });

        document.getElementById('consultasButton').addEventListener('click', () => {
            window.location.href = 'https://jheynial.github.io/MageSaude/Public/pages/consultas/consultas.html'; // Corrigindo o redirecionamento para o diretório correto
        });

        // Função para formatar o CPF
        function formatarCPF(cpf) {
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        // Função para formatar o número de telefone
        function formatarTelefone(telefone) {
            return telefone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
        }
    </script>
    <script src="/MageSaude/Public/script.js" defer></script>
    <script src="https://kit.fontawesome.com/998c60ef77.js" crossorigin="anonymous"></script>
</body>
</html>
